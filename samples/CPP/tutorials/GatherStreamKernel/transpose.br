////////////////////////////////////////////////////////////////////////////////
//!
//! \file   transpose.br
//!
//! \brief  Defines the transpose kernel
//!
////////////////////////////////////////////////////////////////////////////////

////////////////////////////////////////////////////////////////////////////////
//!
//! \brief  Matrix transpose function using gather stream
//!
//! \param  i   Input(gather) stream
//! \param  o   Output stream
//!
////////////////////////////////////////////////////////////////////////////////

kernel void
transposeGPU(float i[][], out float o<>)
{
    // Get the (x,y) position of o in (index.x, index.y)
    int2 index = instance().xy;

    // Fetch a value from (y,x)
    o = i[index.x][index.y];
}
